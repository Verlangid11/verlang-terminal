FROM debian:bookworm-slimLABEL author="verlangid" maintainer="verlangid@gmail.com"ENV DEBIAN_FRONTEND=noninteractive \    USER=container \    HOME=/home/container \    NODE_DIR=/home/container/node \    BUN_DIR=/usr/local/bun \    PLAYWRIGHT_DIR=/usr/local/share/playwright \    GO_VERSION=1.23.5 \    PYTHON_VERSION=3.12.8 \    RUBY_VERSION=3.3.0 \    PHP_VERSION=8.3 \    JAVA_VERSION=21ENV PATH="$NODE_DIR/bin:$BUN_DIR/bin:/usr/local/go/bin:$HOME/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"RUN apt-get update && apt-get install -y --no-install-recommends \        curl wget git zip unzip tar gzip bzip2 p7zip-full xz-utils \        jq nano vim ca-certificates gnupg lsb-release \        net-tools iputils-ping dnsutils procps htop \        build-essential make gcc g++ libssl-dev zlib1g-dev \        libbz2-dev libreadline-dev libsqlite3-dev \        libncursesw5-dev tk-dev libffi-dev liblzma-dev \        ffmpeg imagemagick webp mediainfo \        supervisor \    && mkdir -p --mode=0755 /usr/share/keyrings \    && curl -fsSL https://pkg.cloudflare.com/cloudflare-public-v2.gpg | gpg --dearmor > /usr/share/keyrings/cloudflare-public-v2.gpg \    && echo 'deb [signed-by=/usr/share/keyrings/cloudflare-public-v2.gpg] https://pkg.cloudflare.com/cloudflared any main' | tee /etc/apt/sources.list.d/cloudflared.list \    && apt-get update && apt-get install -y cloudflared \    && rm -rf /var/lib/apt/lists/*RUN apt-get update && apt-get install -y --no-install-recommends \        fonts-liberation fonts-noto-color-emoji libfontconfig1 \        libasound2 libgbm1 libgtk-3-0 libnss3 libnspr4 \        libatk1.0-0 libatk-bridge2.0-0 libcups2 libdrm2 \        libdbus-1-3 libxcb-dri3-0 libxss1 libxtst6 \    && rm -rf /var/lib/apt/lists/*RUN cd /tmp \    && wget -q https://go.dev/dl/go${GO_VERSION}.linux-amd64.tar.gz \    && tar -C /usr/local -xzf go${GO_VERSION}.linux-amd64.tar.gz \    && rm go${GO_VERSION}.linux-amd64.tar.gzRUN cd /tmp \    && wget -q https://www.python.org/ftp/python/${PYTHON_VERSION}/Python-${PYTHON_VERSION}.tgz \    && tar xzf Python-${PYTHON_VERSION}.tgz \    && cd Python-${PYTHON_VERSION} \    && ./configure --enable-optimizations --with-ensurepip=install \    && make -j$(nproc) altinstall \    && ln -sf /usr/local/bin/python3.12 /usr/local/bin/python3 \    && ln -sf /usr/local/bin/pip3.12 /usr/local/bin/pip3 \    && pip3 install --upgrade pip setuptools wheel \    && cd /tmp && rm -rf Python-${PYTHON_VERSION}*RUN cd /tmp \    && wget -q https://github.com/oven-sh/bun/releases/latest/download/bun-linux-x64.zip \    && unzip -q bun-linux-x64.zip \    && mkdir -p $BUN_DIR/bin \    && mv bun-linux-x64/bun $BUN_DIR/bin/bun \    && chmod +x $BUN_DIR/bin/bun \    && rm -rf bun-linux-x64*RUN apt-get update \    && apt-get install -y --no-install-recommends ruby-full \    && gem install bundler \    && rm -rf /var/lib/apt/lists/*RUN apt-get update \    && apt-get install -y --no-install-recommends php${PHP_VERSION} php${PHP_VERSION}-cli php${PHP_VERSION}-common php${PHP_VERSION}-curl php${PHP_VERSION}-mbstring php${PHP_VERSION}-xml \    && curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer \    && rm -rf /var/lib/apt/lists/*RUN apt-get update \    && mkdir -p /etc/apt/keyrings \    && wget -O - https://packages.adoptium.net/artifactory/api/gpg/key/public | tee /etc/apt/keyrings/adoptium.asc \    && echo "deb [signed-by=/etc/apt/keyrings/adoptium.asc] https://packages.adoptium.net/artifactory/deb $(awk -F= '/^VERSION_CODENAME/{print$2}' /etc/os-release) main" | tee /etc/apt/sources.list.d/adoptium.list \    && apt-get update \    && apt-get install -y temurin-${JAVA_VERSION}-jdk \    && rm -rf /var/lib/apt/lists/*RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \    && apt-get install -y nodejs \    && npm install -g playwright \    && mkdir -p $PLAYWRIGHT_DIR \    && PLAYWRIGHT_BROWSERS_PATH=$PLAYWRIGHT_DIR npx playwright install --with-deps chromium \    && apt-get purge -y nodejs \    && apt-get autoremove -y \    && rm -rf /var/lib/apt/lists/* \    && chmod -R 755 $PLAYWRIGHT_DIRRUN useradd -m -d /home/container -s /bin/bash container \    && mkdir -p $NODE_DIR \    && chown -R container:container /home/containerRUN echo '[supervisord]' > /etc/supervisor/conf.d/cloudflared.conf \    && echo 'nodaemon=true' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'logfile=/dev/null' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'logfile_maxbytes=0' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo '' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo '[program:cloudflared]' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'command=/bin/bash -c "[ -f /tmp/cf_enabled ] && cloudflared tunnel run --token $(cat /tmp/cf_token) || sleep infinity"' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'autostart=true' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'autorestart=true' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'stdout_logfile=/home/container/.cloudflared.log' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'stderr_logfile=/home/container/.cloudflared.log' >> /etc/supervisor/conf.d/cloudflared.conf \    && echo 'user=container' >> /etc/supervisor/conf.d/cloudflared.confUSER containerWORKDIR /home/containerCOPY --chown=container:container entrypoint.sh /entrypoint.shRUN chmod +x /entrypoint.shCMD ["/bin/bash", "/entrypoint.sh"]